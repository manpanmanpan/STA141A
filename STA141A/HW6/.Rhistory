theme(plot.title = element_text(hjust = 0.5))#title location
p1
p1 <- ggplot(data = da, aes(x = x))+
geom_bar(aes(y = y),fill = "#6794a7",stat="identity",position = "dodge",width = 0.6)+
geom_bar(aes(y = z),fill = "grey",stat="identity",position = "dodge",width = 0.6)+
geom_line(aes(y = max(da$y)/max(da$m)*da$m/2))+
geom_point(aes(y = max(da$y)/max(da$m)*da$m/2),size=2)+
scale_y_continuous(name = "",breaks=seq(0,3500000,500000),sec.axis =
sec_axis(~./max(da$y)*max(da$m)*2,breaks=seq(2,12,2),name="percentage",labels = function(a){return(paste0(a,"%"))}))+
scale_x_continuous(name = "Year",breaks=2010:2017)+
geom_text(aes(y=y,label=y,vjust = -0.4,hjust = 0.5),size = 4)+
geom_text(aes(y=z,label=z,vjust = -0.4,hjust = 0.5),size = 4)+
geom_text(aes(y=max(da$y)/max(da$m)*da$m/2,label=paste0(m,"%"),vjust = -0.8,hjust = 0.5))+
labs(
title="Sepsis Hospitalizations and Case Mortality Rates(%) California: 2010-2017 (Annual)",
subtitle="This is a Subtitle",
caption="This is a Caption"
)+
theme(plot.title = element_text(hjust = 0.5))#title location
p1
p1 <- ggplot(data = da, aes(x = x))+
geom_bar(aes(y = y),fill = "#6794a7",stat="identity",position = "dodge",width = 0.6)+
geom_bar(aes(y = z),fill = "lightblue",stat="identity",position = "dodge",width = 0.6)+
geom_line(aes(y = max(da$y)/max(da$m)*da$m/2))+
geom_point(aes(y = max(da$y)/max(da$m)*da$m/2),size=2)+
scale_y_continuous(name = "",breaks=seq(0,3500000,500000),sec.axis =
sec_axis(~./max(da$y)*max(da$m)*2,breaks=seq(2,12,2),name="percentage",labels = function(a){return(paste0(a,"%"))}))+
scale_x_continuous(name = "Year",breaks=2010:2017)+
geom_text(aes(y=y,label=y,vjust = -0.4,hjust = 0.5),size = 4)+
geom_text(aes(y=z,label=z,vjust = -0.4,hjust = 0.5),size = 4)+
geom_text(aes(y=max(da$y)/max(da$m)*da$m/2,label=paste0(m,"%"),vjust = -0.8,hjust = 0.5))+
labs(
title="Sepsis Hospitalizations and Case Mortality Rates(%) California: 2010-2017 (Annual)",
subtitle="This is a Subtitle",
caption="This is a Caption"
)+
theme(plot.title = element_text(hjust = 0.5))#title location
p1
p1 <- ggplot(data = da, aes(x = x))+
geom_bar(aes(y = y),fill = "#6794a7",stat="identity",position = "dodge",width = 0.6)+
geom_bar(aes(y = z),fill = "lightgreen",stat="identity",position = "dodge",width = 0.6)+
geom_line(aes(y = max(da$y)/max(da$m)*da$m/2))+
geom_point(aes(y = max(da$y)/max(da$m)*da$m/2),size=2)+
scale_y_continuous(name = "",breaks=seq(0,3500000,500000),sec.axis =
sec_axis(~./max(da$y)*max(da$m)*2,breaks=seq(2,12,2),name="percentage",labels = function(a){return(paste0(a,"%"))}))+
scale_x_continuous(name = "Year",breaks=2010:2017)+
geom_text(aes(y=y,label=y,vjust = -0.4,hjust = 0.5),size = 4)+
geom_text(aes(y=z,label=z,vjust = -0.4,hjust = 0.5),size = 4)+
geom_text(aes(y=max(da$y)/max(da$m)*da$m/2,label=paste0(m,"%"),vjust = -0.8,hjust = 0.5))+
labs(
title="Sepsis Hospitalizations and Case Mortality Rates(%) California: 2010-2017 (Annual)",
subtitle="This is a Subtitle",
caption="This is a Caption"
)+
theme(plot.title = element_text(hjust = 0.5))#title location
p1
p1 <- ggplot(data = da, aes(x = x))+
geom_bar(aes(y = y),fill = "lightgreen",stat="identity",position = "dodge",width = 0.6)+
geom_bar(aes(y = z),fill = "lightgreen",stat="identity",position = "dodge",width = 0.6)+
geom_line(aes(y = max(da$y)/max(da$m)*da$m/2))+
geom_point(aes(y = max(da$y)/max(da$m)*da$m/2),size=2)+
scale_y_continuous(name = "",breaks=seq(0,3500000,500000),sec.axis =
sec_axis(~./max(da$y)*max(da$m)*2,breaks=seq(2,12,2),name="percentage",labels = function(a){return(paste0(a,"%"))}))+
scale_x_continuous(name = "Year",breaks=2010:2017)+
geom_text(aes(y=y,label=y,vjust = -0.4,hjust = 0.5),size = 4)+
geom_text(aes(y=z,label=z,vjust = -0.4,hjust = 0.5),size = 4)+
geom_text(aes(y=max(da$y)/max(da$m)*da$m/2,label=paste0(m,"%"),vjust = -0.8,hjust = 0.5))+
labs(
title="Sepsis Hospitalizations and Case Mortality Rates(%) California: 2010-2017 (Annual)",
subtitle="This is a Subtitle",
caption="This is a Caption"
)+
theme(plot.title = element_text(hjust = 0.5))#title location
p1
p1 <- ggplot(data = da, aes(x = x))+
geom_bar(aes(y = y),fill = "lightblue",stat="identity",position = "dodge",width = 0.6)+
geom_bar(aes(y = z),fill = "lightgreen",stat="identity",position = "dodge",width = 0.6)+
geom_line(aes(y = max(da$y)/max(da$m)*da$m/2))+
geom_point(aes(y = max(da$y)/max(da$m)*da$m/2),size=2)+
scale_y_continuous(name = "",breaks=seq(0,3500000,500000),sec.axis =
sec_axis(~./max(da$y)*max(da$m)*2,breaks=seq(2,12,2),name="percentage",labels = function(a){return(paste0(a,"%"))}))+
scale_x_continuous(name = "Year",breaks=2010:2017)+
geom_text(aes(y=y,label=y,vjust = -0.4,hjust = 0.5),size = 4)+
geom_text(aes(y=z,label=z,vjust = -0.4,hjust = 0.5),size = 4)+
geom_text(aes(y=max(da$y)/max(da$m)*da$m/2,label=paste0(m,"%"),vjust = -0.8,hjust = 0.5))+
labs(
title="Sepsis Hospitalizations and Case Mortality Rates(%) California: 2010-2017 (Annual)",
subtitle="This is a Subtitle",
caption="This is a Caption"
)+
theme(plot.title = element_text(hjust = 0.5))#title location
p1
p1 <- ggplot(data = da, aes(x = x))+
geom_bar(aes(y = y),fill = "lightblue",stat="identity",position = "dodge",width = 0.6)+
geom_bar(aes(y = z),fill = "gray",stat="identity",position = "dodge",width = 0.6)+
geom_line(aes(y = max(da$y)/max(da$m)*da$m/2))+
geom_point(aes(y = max(da$y)/max(da$m)*da$m/2),size=2)+
scale_y_continuous(name = "",breaks=seq(0,3500000,500000),sec.axis =
sec_axis(~./max(da$y)*max(da$m)*2,breaks=seq(2,12,2),name="percentage",labels = function(a){return(paste0(a,"%"))}))+
scale_x_continuous(name = "Year",breaks=2010:2017)+
geom_text(aes(y=y,label=y,vjust = -0.4,hjust = 0.5),size = 4)+
geom_text(aes(y=z,label=z,vjust = -0.4,hjust = 0.5),size = 4)+
geom_text(aes(y=max(da$y)/max(da$m)*da$m/2,label=paste0(m,"%"),vjust = -0.8,hjust = 0.5))+
labs(
title="Sepsis Hospitalizations and Case Mortality Rates(%) California: 2010-2017 (Annual)",
subtitle="This is a Subtitle",
caption="This is a Caption"
)+
theme(plot.title = element_text(hjust = 0.5))#title location
p1
p1 <- ggplot(data = da, aes(x = x))+
geom_bar(aes(y = y),fill = "lightblue",stat="identity",position = "dodge",width = 0.6)+
geom_bar(aes(y = z),fill = "gray",stat="identity",position = "dodge",width = 0.6)+
geom_line(aes(y = max(da$y)/max(da$m)*da$m/2))+
geom_point(aes(y = max(da$y)/max(da$m)*da$m/2),size=2)+
scale_y_continuous(name = "",breaks=seq(0,3500000,500000),sec.axis =
sec_axis(~./max(da$y)*max(da$m)*2,breaks=seq(2,12,2),name="percentage",labels = function(a){return(paste0(a,"%"))}))+
scale_x_continuous(name = "Year",breaks=2010:2017)+
geom_text(aes(y=y,label=y,vjust = -0.4,hjust = 0.5),size = 4)+
geom_text(aes(y=z,label=z,vjust = -0.4,hjust = 0.5),size = 4)+
geom_text(aes(y=max(da$y)/max(da$m)*da$m/2,label=paste0(round = 2,m,"%"),vjust = -0.8,hjust = 0.5))+
labs(
title="Sepsis Hospitalizations and Case Mortality Rates(%) California: 2010-2017 (Annual)",
subtitle="This is a Subtitle",
caption="This is a Caption"
)+
theme(plot.title = element_text(hjust = 0.5))#title location
p1
p1 <- ggplot(data = da, aes(x = x))+
geom_bar(aes(y = y),fill = "lightblue",stat="identity",position = "dodge",width = 0.6)+
geom_bar(aes(y = z),fill = "gray",stat="identity",position = "dodge",width = 0.6)+
geom_line(aes(y = max(da$y)/max(da$m)*da$m/2))+
geom_point(aes(y = max(da$y)/max(da$m)*da$m/2),size=2)+
scale_y_continuous(name = "",breaks=seq(0,3500000,500000),sec.axis =
sec_axis(~./max(da$y)*max(da$m)*2,breaks=seq(2,12,2),name="percentage",labels = function(a){return(paste0(a,"%"))}))+
scale_x_continuous(name = "Year",breaks=2010:2017)+
geom_text(aes(y=y,label=y,vjust = -0.4,hjust = 0.5),size = 4)+
geom_text(aes(y=z,label=z,vjust = -0.4,hjust = 0.5),size = 4)+
geom_text(aes(y=max(da$y)/max(da$m)*da$m/2,label=paste0(round = 3,m,"%"),vjust = -0.8,hjust = 0.5))+
labs(
title="Sepsis Hospitalizations and Case Mortality Rates(%) California: 2010-2017 (Annual)",
subtitle="This is a Subtitle",
caption="This is a Caption"
)+
theme(plot.title = element_text(hjust = 0.5))#title location
p1
p1 <- ggplot(data = da, aes(x = x))+
geom_bar(aes(y = y),fill = "lightblue",stat="identity",position = "dodge",width = 0.6)+
geom_bar(aes(y = z),fill = "gray",stat="identity",position = "dodge",width = 0.6)+
geom_line(aes(y = max(da$y)/max(da$m)*da$m/2))+
geom_point(aes(y = max(da$y)/max(da$m)*da$m/2),size=2)+
scale_y_continuous(name = "",breaks=seq(0,3500000,500000),sec.axis =
sec_axis(~./max(da$y)*max(da$m)*2,breaks=seq(2,12,2),name="percentage",labels = function(a){return(paste0(a,"%"))}))+
scale_x_continuous(name = "Year",breaks=2010:2017)+
geom_text(aes(y=y,label=y,vjust = -0.4,hjust = 0.5),size = 4)+
geom_text(aes(y=z,label=z,vjust = -0.4,hjust = 0.5),size = 4)+
geom_text(aes(y=max(da$y)/max(da$m)*da$m/2,label=paste0(round(m,2),"%"),vjust = -0.8,hjust = 0.5))+
labs(
title="Sepsis Hospitalizations and Case Mortality Rates(%) California: 2010-2017 (Annual)",
subtitle="This is a Subtitle",
caption="This is a Caption"
)+
theme(plot.title = element_text(hjust = 0.5))#title location
p1
p1 <- ggplot(data = da, aes(x = x))+
geom_bar(aes(y = y),fill = "lightblue",stat="identity",position = "dodge",width = 0.6)+
geom_bar(aes(y = z),fill = "gray",stat="identity",position = "dodge",width = 0.6)+
geom_line(aes(y = max(da$y)/max(da$m)*da$m/2))+
geom_point(aes(y = max(da$y)/max(da$m)*da$m/2),size=2)+
scale_y_continuous(name = "",breaks=seq(0,3500000,500000),sec.axis =
sec_axis(~./max(da$y)*max(da$m)*2,breaks=seq(2,12,2),name="percentage",labels = function(a){return(paste0(a,"%"))}))+
scale_x_continuous(name = "Year",breaks=2010:2017)+
geom_text(aes(y=y,label=y,vjust = -0.4,hjust = 0.5),size = 4)+
geom_text(aes(y=z,label=z,vjust = -0.4,hjust = 0.5),size = 4)+
geom_text(aes(y=max(da$y)/max(da$m)*da$m/2,label=paste0(sprintf("%.1f", m),"%"),vjust = -0.8,hjust = 0.5))+
labs(
title="Sepsis Hospitalizations and Case Mortality Rates(%) California: 2010-2017 (Annual)",
subtitle="This is a Subtitle",
caption="This is a Caption"
)+
theme(plot.title = element_text(hjust = 0.5))#title location
p1
x = c(2010,2011,2012,2013,2014,2015,2016,2017)
y = c(3682406,3640016,3591236,3511443,3501007,3544708,3554135,3563008)
z = c(119338,132538,139379,154617,173517,200790,223072,253020)
m = c(3.20, 3.60, 3.90, 4.40, 5.00, 5.70, 6.30, 7.10)
da = data.frame(x,y,z,m)
library(ggplot2)
p1 <- ggplot(data = da, aes(x = x))+
geom_bar(aes(y = y),fill = "lightblue",stat="identity",position = "dodge",width = 0.6)+
geom_bar(aes(y = z),fill = "gray",stat="identity",position = "dodge",width = 0.6)+
geom_line(aes(y = max(da$y)/max(da$m)*da$m/2))+
geom_point(aes(y = max(da$y)/max(da$m)*da$m/2),size=2)+
scale_y_continuous(name = "",breaks=seq(0,3500000,500000),sec.axis =
sec_axis(~./max(da$y)*max(da$m)*2,breaks=seq(2,12,2),name="percentage",labels = function(a){return(paste0(a,"%"))}))+
scale_x_continuous(name = "Year",breaks=2010:2017)+
geom_text(aes(y=y,label=y,vjust = -0.4,hjust = 0.5),size = 4)+
geom_text(aes(y=z,label=z,vjust = -0.4,hjust = 0.5),size = 4)+
geom_text(aes(y=max(da$y)/max(da$m)*da$m/2,label=paste0(sprintf("%.1f", m),"%"),vjust = -0.8,hjust = 0.5))+
labs(
title="Sepsis Hospitalizations and Case Mortality Rates(%) California: 2010-2017 (Annual)",
subtitle="This is a Subtitle",
caption="This is a Caption"
)+
theme(plot.title = element_text(hjust = 0.5))#title location
p1
###   label=sprintf("%.1f%%", m)
x = c(2010,2011,2012,2013,2014,2015,2016,2017)
y = c(3682406,3640016,3591236,3511443,3501007,3544708,3554135,3563008)
z = c(119338,132538,139379,154617,173517,200790,223072,253020)
m = c(3.20, 3.60, 3.90, 4.40, 5.00, 5.70, 6.30, 7.10)
da = data.frame(x,y,z,m)
library(ggplot2)
p1 <- ggplot(data = da, aes(x = x))+
geom_bar(aes(y = y),fill = "lightblue",stat="identity",position = "dodge",width = 0.6)+
geom_bar(aes(y = z),fill = "gray",stat="identity",position = "dodge",width = 0.6)+
geom_line(aes(y = max(da$y)/max(da$m)*da$m/2))+
geom_point(aes(y = max(da$y)/max(da$m)*da$m/2),size=2)+
scale_y_continuous(name = "",breaks=seq(0,3500000,500000),sec.axis =
sec_axis(~./max(da$y)*max(da$m)*2,breaks=seq(2,12,2),name="percentage",labels = function(a){return(paste0(a,"%"))}))+
scale_x_continuous(name = "Year",breaks=2010:2017)+
geom_text(aes(y=y,label=y,vjust = -0.4,hjust = 0.5),size = 4)+
geom_text(aes(y=z,label=z,vjust = -0.4,hjust = 0.5),size = 4)+
geom_text(aes(y=max(da$y)/max(da$m)*da$m/2,label=paste0(sprintf("%.1f", m),"%"),vjust = -0.8,hjust = 0.5))+
labs(
title="Sepsis Hospitalizations and Case Mortality Rates(%) California: 2010-2017 (Annual)",
subtitle="This is a Subtitle",
caption="This is a Caption"
)+
theme(plot.title = element_text(hjust = 0.5))#title location
p1
library(ggplot2)
x = c(2010,2011,2012,2013,2014,2015,2016,2017)
y = c(3682406,3640016,3591236,3511443,3501007,3544708,3554135,3563008)
z = c(119338,132538,139379,154617,173517,200790,223072,253020)
m = c(3.20, 3.60, 3.90, 4.40, 5.00, 5.70, 6.30, 7.10)
da = data.frame(x,y,z?m)
x = c(2010,2011,2012,2013,2014,2015,2016,2017)
y = c(3682406,3640016,3591236,3511443,3501007,3544708,3554135,3563008)
z = c(119338,132538,139379,154617,173517,200790,223072,253020)
m = c(3.20, 3.60, 3.90, 4.40, 5.00, 5.70, 6.30, 7.10)
da = data.frame(x,y,z?m)
library(ggplot2)
install.packages("ggplot2")
p1 <- ggplot(data = da, aes(x = x))+
geom_bar(aes(y = y),fill = "lightblue",stat="identity",position = "dodge",width = 0.6)+
geom_bar(aes(y = z),fill = "gray",stat="identity",position = "dodge",width = 0.6)+
geom_line(aes(y = ma?(da$y)/max(da$m)*da$m/2))+
geom_point(aes(y = max(da$y)/max(da$m)*da$m/2),size=2)+
scale_y_continuous(name = "",breaks=seq(0,3500000,500000),sec.axis =
sec_axis(~./max(da$y)*max(da$m)*2,breaks=seq(2,12,2),name="percentage",labels = function(a){return(paste0(a,"%"))}))+
scale_x_continuous(name = "Year",breaks=2010:2017)+
geom_text(aes(y=y,label=y,vjust = -0.4,hjust = 0.5),size = 4)+
geom_text(aes(y=z,label=z,vjust = -0.4,hjust = 0.5),size = 4)+
geom_text(aes(y=max(da$y)/max(?a$m)*da$m/2,label=paste0(sprintf("%.1f", m),"%"),vjust = -0.8,hjust = 0.5))+
labs(
title="Sepsis Hospitalizations and Case Mortality Rates(%) California: 2010-2017 (Annual)",
subtitle="This is a Subtitle",
caption="This is a Caption"
)+
t?eme(plot.title = element_text(hjust = 0.5))#title location
library(ggplot2)
p1
p1 <- ggplot(data = da, aes(x = x))+
geom_bar(aes(y = y),fill = "lightblue",stat="identity",position = "dodge",width = 0.6)+
geom_bar(aes(y = z),fill = "gray",stat="identity",position = "dodge",width = 0.6)+
geom_line(aes(y = ma?(da$y)/max(da$m)*da$m/2))+
geom_point(aes(y = max(da$y)/max(da$m)*da$m/2),size=2)+
scale_y_continuous(name = "",breaks=seq(0,3500000,500000),sec.axis =
sec_axis(~./max(da$y)*max(da$m)*2,breaks=seq(2,12,2),name="percentage",labels = function(a){return(paste0(a,"%"))}))+
scale_x_continuous(name = "Year",breaks=2010:2017)+
geom_text(aes(y=y,label=y,vjust = -0.4,hjust = 0.5),size = 4)+
geom_text(aes(y=z,label=z,vjust = -0.4,hjust = 0.5),size = 4)+
geom_text(aes(y=max(da$y)/max(?a$m)*da$m/2,label=paste0(sprintf("%.1f", m),"%"),vjust = -0.8,hjust = 0.5))+
labs(
title="Sepsis Hospitalizations and Case Mortality Rates(%) California: 2010-2017 (Annual)",
subtitle="This is a Subtitle",
caption="This is a Caption"
)+
theme(plot.title = element_text(hjust = 0.5))#title location
x = c(2010,2011,2012,2013,2014,2015,2016,2017)
y = c(3682406,3640016,3591236,3511443,3501007,3544708,3554135,3563008)
z = c(119338,132538,139379,154617,173517,200790,223072,253020)
m = c(3.20, 3.60, 3.90, 4.40, 5.00, 5.70, 6.30, 7.10)
da = data.frame(x,y,z,m)
library(ggplot2)
p1 <- ggplot(data = da, aes(x = x))+
geom_bar(aes(y = y),fill = "lightblue",stat="identity",position = "dodge",width = 0.6)+
geom_bar(aes(y = z),fill = "gray",stat="identity",position = "dodge",width = 0.6)+
geom_line(aes(y = ma?(da$y)/max(da$m)*da$m/2))+
geom_point(aes(y = max(da$y)/max(da$m)*da$m/2),size=2)+
scale_y_continuous(name = "",breaks=seq(0,3500000,500000),sec.axis =
sec_axis(~./max(da$y)*max(da$m)*2,breaks=seq(2,12,2),name="percentage",labels = function(a){return(paste0(a,"%"))}))+
scale_x_continuous(name = "Year",breaks=2010:2017)+
geom_text(aes(y=y,label=y,vjust = -0.4,hjust = 0.5),size = 4)+
geom_text(aes(y=z,label=z,vjust = -0.4,hjust = 0.5),size = 4)+
geom_text(aes(y=max(da$y)/max(?a$m)*da$m/2,label=paste0(sprintf("%.1f", m),"%"),vjust = -0.8,hjust = 0.5))+
labs(
title="Sepsis Hospitalizations and Case Mortality Rates(%) California: 2010-2017 (Annual)",
subtitle="This is a Subtitle",
caption="This is a Caption"
)+
theme(plot.title = element_text(hjust = 0.5))#title location
p1
p1 <- ggplot(data = da, aes(x = x))+
geom_bar(aes(y = y),fill = "lightblue",stat="identity",position = "dodge",width = 0.6)+
geom_bar(aes(y = z),fill = "gray",stat="identity",position = "dodge",width = 0.6)+
geom_line(aes(y = max(da$y)/max(da$m)*da$m/2))+
geom_point(aes(y = max(da$y)/max(da$m)*da$m/2),size=2)+
scale_y_continuous(name = "",breaks=seq(0,3500000,500000),sec.axis =
sec_axis(~./max(da$y)*max(da$m)*2,breaks=seq(2,12,2),name="percentage",labels = function(a){return(paste0(a,"%"))}))+
scale_x_continuous(name = "Year",breaks=2010:2017)+
geom_text(aes(y=y,label=y,vjust = -0.4,hjust = 0.5),size = 4)+
geom_text(aes(y=z,label=z,vjust = -0.4,hjust = 0.5),size = 4)+
geom_text(aes(y=max(da$y)/max(?a$m)*da$m/2,label=paste0(sprintf("%.1f", m),"%"),vjust = -0.8,hjust = 0.5))+
labs(
title="Sepsis Hospitalizations and Case Mortality Rates(%) California: 2010-2017 (Annual)",
subtitle="This is a Subtitle",
caption="This is a Caption"
)+
theme(plot.title = element_text(hjust = 0.5))#title location
p1
x = c(2010,2011,2012,2013,2014,2015,2016,2017)
y = c(3682406,3640016,3591236,3511443,3501007,3544708,3554135,3563008)
z = c(119338,132538,139379,154617,173517,200790,223072,253020)
m = c(3.20, 3.60, 3.90, 4.40, 5.00, 5.70, 6.30, 7.10)
da = data.frame(x,y,z,m)
library(ggplot2)
p1 <- ggplot(data = da, aes(x = x))+
geom_bar(aes(y = y),fill = "lightblue",stat="identity",position = "dodge",width = 0.6)+
geom_bar(aes(y = z),fill = "gray",stat="identity",position = "dodge",width = 0.6)+
geom_line(aes(y = max(da$y)/max(da$m)*da$m/2))+
geom_point(aes(y = max(da$y)/max(da$m)*da$m/2),size=2)+
scale_y_continuous(name = "",breaks=seq(0,3500000,500000),sec.axis =
sec_axis(~./max(da$y)*max(da$m)*2,breaks=seq(2,12,2),name="percentage",labels = function(a){return(paste0(a,"%"))}))+
scale_x_continuous(name = "Year",breaks=2010:2017)+
geom_text(aes(y=y,label=y,vjust = -0.4,hjust = 0.5),size = 4)+
geom_text(aes(y=z,label=z,vjust = -0.4,hjust = 0.5),size = 4)+
geom_text(aes(y=max(da$y)/max(da$m)*da$m/2,label=paste0(sprintf("%.1f", m),"%"),vjust = -0.8,hjust = 0.5))+
labs(
title="Sepsis Hospitalizations and Case Mortality Rates(%) California: 2010-2017 (Annual)",
subtitle="This is a Subtitle",
caption="This is a Caption"
)+
theme(plot.title = element_text(hjust = 0.5))#title location
p1
p1 <- ggplot(data = da, aes(x = x))+
geom_bar(aes(y = y),fill = "lightblue",stat="identity",position = "dodge",width = 0.6)+
geom_bar(aes(y = z),fill = "gray",stat="identity",position = "dodge",width = 0.6)+
geom_line(aes(y = max(da$y)/max(da$m)*da$m/2))+
geom_point(aes(y = max(da$y)/max(da$m)*da$m/2),size=2)+
scale_y_continuous(name = "",breaks=seq(0,3500000,500000),sec.axis =
sec_axis(~./max(da$y)*max(da$m)*2,breaks=seq(2,12,2),name="percentage",labels = function(a){return(paste0(a,"%"))}))+
scale_x_continuous(name = "Year",breaks=2010:2017)+
geom_text(aes(y=y,label=y,vjust = -0.4,hjust = 0.5),size = 4)+
geom_text(aes(y=z,label=z,vjust = -0.4,hjust = 0.5),size = 4)+
geom_text(aes(y=max(da$y)/max(da$m)*da$m/2,label=paste0(sprintf("%.1f", m),"%"),vjust = -0.8,hjust = 0.5))+
labs(
title="Sepsis Hospitalizations and Case Mortality Rates(%) California: 2010-2017 (Annual)",
subtitle="",
caption=" "
)+
theme(plot.title = element_text(hjust = 0.5))#title location
p1
library(devtools)
library(RCurl)
library(httr)
set_config( config( ssl_verifypeer = 0L ) )
devtools::install_github("dgrtwo/gganimate")
library(ggplot2)
library(ggplot2)
pchisq(5.428,1)
pchisq(9.786,1,lower.tail = FALSE)
### CA map
library(maps)
us_states = map_data ("state")
### CA map
library(maps)
us_states = map_data ("state")
ca_df = subset(us_states, region == "california")
counties = map_data("county")
library(ggplot2)
library(gridExtra)
### CA map
library(maps)
us_states = map_data ("state")
ca_df = subset(us_states, region == "california")
counties = map_data("county")
ca_county = subset(counties, region == "california")
ca_base = ggplot(ca_df, mapping = aes(x = long, y = lat, group = group)) + coord_fixed(1.3) +
geom_polygon(color = "black", fill = "gray")
ca_base
source('F:/141A/HW3/141A HW3.R')
posts = sapply(files, function(file) {
options(error = NULL)
posts = sapply(files, function(file) {
post_string = str_c(post, collapse = "\n")
# how to grab characters before and after a pattern in a string?
x=c('The blue cat was fluffy.','The red dog liked to bark.')
pattern = 'dog|cat'
str_extrcat(x, pattern)
library(stringr)
str_extract(x, pattern)
pattern = '\\w dog|cat'
str_extract(x, pattern)
?regex
pattern = '\\wdog|cat'
str_extract(x, pattern)
pattern = '\\w+ (dog|cat)'
str_extract(x, pattern)
pattern = '[A-Za-z]+ (dog|cat)'
str_extract(x, pattern)
str_match(x,pattern)
pattern = '([A-Za-z])+ (dog|cat)'
str_match(x,pattern)
pattern = '([A-Za-z]{3}) (dog|cat)'
str_match(x,pattern)
pattern = '([A-Za-z]) (dog|cat)'
str_match(x,pattern)
pattern = '([A-Za-z])+ (dog|cat)'
str_match(x,pattern)
str_extract('aaaaaaab',pattern)
str_extract('aaaaaaaaab',pattern)
# how does {} work in regex?
pattern = ' (a{3})b'
str_extract('aaaaaaaab',pattern)
str_match('aaaaaaaab',pattern)
str_detect("A","a")
str_detect("A",regex('a',ignore.case = T))
# LOOKAHEAD and LOOKBEHIND
x = c('blue cat','blue dog','red dog')
# we would like to match any word that comes after "blue", and just extract that word
str_match(x,"blue (\\w+)")
# we could also do this using lookaheads and lookbehinds
str_extract(x,"(?<=blue )\\w+")  # lookbehind
# what does the word() function do ?
x = c("The cat was blue")
word(x,2)
str_split(x, " ")
word(x, 4)
# how do date processing and date format strings work?
x = "27 November 11:38am 2018"
?strptime
strptime(x,"%d %B")
strptime(x,"%d %B %H")
strptime(x,"%d %B %H:%M")
strptime(x,"%d %B %H:%M%p")
strptime(x,"%d %B %H:%M%p %Y")
result = strptime(x,"%d %B %H:%M%p %Y")
# you can set the timezone with tz=
class(result)
x = "Nov 27 2018"
strptime(x,"%b %d %Y")
library(lubridate)
install.packages("lubridate")
library(lubridate)
result
library(lubridate)
lubridate?::is.Date
setwd("F:/141A/HW6")
# Q1
set.seed(111)
read_digits = function(file_name){
# INPUTS: file name
# OUTPUTS: data frame
path = 'digits/'
temp = paste('digits/',file_name,sep="")
data = read.table(paste(temp,'.txt',sep=""))
}
train = read_digits('train')
test = read_digits('test')
# Q3
label = train[,1]
dataset  = train[,2:257]
test_label = test[,1]
test_dataset  = test[,2:257]
# Q6
predict_KNN = function(test_dataset,k,dataset,label, dis){
# INPUTS: predict points, k parameter,train dataset, train dataset's label, euclidean/manhattan distance
# OUTPUTS: predict label
distance = dis[(nrow(test_dataset)+1):nrow(dis),1:nrow(test_dataset)]
sorteddisindex = apply(distance,2,order)
temp2 = sorteddisindex[1:k,]
if (k==1){temp4=label[temp2]}
else {
temp4 = rep(0,nrow(test_dataset))
for (i in (1:ncol(temp2))){
temp3 = table(label[temp2[,i]])[order(table(label[temp2[,i]]))]
temp4[i] = as.numeric(names(temp3)[length(temp3)])
}
}
return(temp4)
}
d_E = as.matrix(dist(rbind(test_dataset, dataset),method = "euclidean", upper = TRUE, diag = TRUE))
d_M = as.matrix(dist(rbind(test_dataset, dataset),method = "manhattan", upper = TRUE, diag = TRUE))
err3 = function(test_dataset,k,dataset,label,test_label,dis){
# INPUTS: predict points, k, train dataset, train label, test label, distance method
# OUTPUTS: error rate estimator
get_label = predict_KNN(test_dataset,k,dataset,label,dis)
ori_label = test_label
err = sum(get_label != ori_label)/length(ori_label)
return(err)
}
# confusion matrix
get_label = predict_KNN(test_dataset,1,dataset,label, d_E)
ori_label = test_label
tb = as.matrix(table(ori_label, get_label))
# mis-classification for each label
mistake = ((rowSums(tb)) - diag(tb))/rowSums(tb)
sort(round(mistake,3))
b
tb
